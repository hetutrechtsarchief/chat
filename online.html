<!DOCTYPE html>
<html>
<head>
  <title>Het Utrechts Archief</title>
  <meta charset="utf-8">
  <!-- <meta http-equiv="refresh" content="10; URL=?"> -->
  <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
  <link rel="stylesheet" type="text/css" href="styles.css?">
</head>

<body>
  <div class="btnIcon" id="btnChat">
    <img src="img/icon-chat.png?">
  </div>

  <div id="chatContent">
    <div id="contentOnline">
      <p>Heeft u een vraag? Tussen 13.30 â€“ 16.30 uur helpen wij u graag via chat!</p>
      <a id="linkOpenChatWindow" href="#" target="_blank">
        <p><img src="status.php"></p>
        <p class="greenbutton">Stel uw vraag &gt;</p>
      </a>
    </div>

    <div id="contentOffline">
      <p><img src="status.php"></p>
      <p>Van di t/m vrij 13.30-16.30 uur kunt u met ons chatten. Momenteel zijn we offline, stel uw vraag via <a href="mailto:inlichtingen@hetutrechtsarchief.nl">inlichtingen@hetutrechtsarchief.nl</a>.</p>
    </div>
  </div>


<script>

  //onload
  fetch('status.php?json')
  .then(function(response) {
    return response.json();
  })
  .then(function(json) {
    window.chatStatus = json.status;
  });

  $(document).mouseleave(function() {
    $("#chatContent").hide();
  });

  //click
  $("#btnChat").click(function() {
    $("#linkOpenChatWindow").trigger("click");
  });

  //click
  $("#linkOpenChatWindow").click(function(event) {
    $("#chatContent").hide();
    if (window.chatStatus!="offline") {
      var url = "https://eu.libraryh3lp.com/chat/het-utrechts-archief@chat.eu.libraryh3lp.com?skin=15209";
      window.open(url,'_blank','height=400,width=730');
    }
    event.preventDefault();
    return false;
  });

  $("#chatContent").click(function(event) {
      $("#chatContent").hide();
  })

  //mouseover
  $("#btnChat").mouseover(function() {
    $("#chatContent").show();

    if (window.chatStatus=="offline") {    
      $("#contentOnline").hide();
      $("#contentOffline").show();
    } else {
      $("#contentOffline").hide();
      $("#contentOnline").show();
    }
  });

</script>

</body>
</html>